---
layout: default
title: General - Attacks against Scripts
---

<h1>General: Attacks against Scripts</h1>


<P>
Plainly the worst possible situation is a machine directly connected to the internet with all its <A href="http://en.wikipedia.org/wiki/Port_%28computer_networking%29">ports</A> open 
and with no root password, or the default user password, and a fixed <A href="http://en.wikipedia.org/wiki/IP_address">IP address</A>. It is a simple matter to contact such a machine via <A href="http://en.wikipedia.org/wiki/Telnet">telnet</A> or <A href="http://en.wikipedia.org/wiki/File_Transfer_Protocol">FTP</A> and log in as root or the default user (who usually has admin rights). Even if an attacker doesn't have admin rights, if they have write-permission to web directories, they can cause a great deal of trouble. Even if the default passwords are changed, you need to make sure they are 
<A href="http://en.wikipedia.org/wiki/Password_strength">strong</A> one (i.e. not a common word, or word and numbers: <A href="https://support.google.com/accounts/answer/32040?hl=en">advice from Google</A>) as an open 
login console encourages people to try <A href="http://en.wikipedia.org/wiki/Password_cracking">brute-force guessing of passwords</A>, essentially running through lists of words and testing them. In addition, you should only 
ever log into your system on an encrypted line, for example a <A href="http://en.wikipedia.org/wiki/Secure_Shell">SSH</A> connection, to lower the risk of 
<A href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">MIM attacks</A>.
</P>
<p>
This setup, however, is not now common. Most computers now are surrounded by a <A href="http://en.wikipedia.org/wiki/Firewall_%28computing%29">Firewall</A> - a piece of software that closes all ports on a machine to externally-started communications and monitors for a wide  range of common attacks. Moreover, most PCs connect to the internet via a 
<A href="http://en.wikipedia.org/wiki/Router_%28computing%29">router</A> - a piece of 
hardware that allows multiple machines to connect to the internet at the same time. Routers usually have their own 
firewall that splits the network into the external network, and an internal private network with higher 
privileges. Firewalls generally don't allow external machines to intiate communications with internal machines, only 
allowing responses to communications initiated from inside the firewall. 
</P>
<P>
Nevertheless, 
web servers present a particular issue. Webservers have to accept external communications, at least on port 80. 
They do this through <A href="http://en.wikipedia.org/wiki/Port_forwarding">port forwarding</A>, where a network firewall on a router 
is set up to listen for port 80 communication and forward requests to 
the server machine (quite often Port 22 is also open to allow SSH admin connections, though you are better off doing these from internal machines 
if possible). 
If web servers just allowed for <A href="http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods">HTTP GET requests</A> 
(the requests for webpages etc.) for simple web resources, this would be fine, but most 
also want to allow <A href="http://www.w3schools.com/tags/ref_httpmethods.asp">POST and PUT</A> 
requests (requests for adjusting the state of the server), especially when dealing with processing HTML-based <A href="http://www.w3schools.com/html/html_forms.asp">forms</A> using scripts on the server (e.g. with <A href="http://en.wikipedia.org/wiki/Perl">Perl</A> or PHP; <A href="http://www.tjhsst.edu/~dhyatt/supercomp/perl1.html">example</A>). Often these requests will 
include information to send to the scripts (as, infact, can GET). The scripts then take this information in and store it, opening 
themselves up to exploitation. While we're on the subject, it should also be noticed that HTTP GET and PUT requests encode information into the URL that is 
sent, so users can read any information in these very easily. Encoding is done in this form:
</P>
<P>
<CODE>
http://www.oggy.com/script.php?variable=value;&amp;variable2=value2
</CODE>
</P>
<P>
This is both trivial for the user to read, but is also stored in web logs and sometimes available (for example, through the DOM 
<A href="http://www.w3schools.com/jsref/prop_doc_referrer.asp">document.referrer</A> object) to subsequent webpages.
</P>

<P>To understand why information sent to a server might be problematic, we need to understand a typical attack. 
By and large attacks against machines exploit issues with software that open up security holes. A classic example 
is the <A href="http://en.wikipedia.org/wiki/Buffer_overflow">Buffer overflow</A> attack which (broadly) writes 
larger data to arrays in a program than the program is expecting, spilling the data out of the program's memory areas and into the surrounding 
OS code. To run such an exploit, however, an attacker needs to be able to run a program on the computer. This isn't usually simple, but with 
web servers the options are higher as information is often sent to the scripts running. The other classic attack, often 
combined with the Buffer Overflow, is to write input that evaluates to make a running program. If a server script is 
foolish enough to run input sent to it without checking the input, the server can be made to run arbitrary programs with the web server software's 
permission privileges, which are often quite high. If the server script runs a program with <KBD>sudo</KBD>, this can be especially devastating. We'll see 
another example of where sending data to scripts is problematic when we look at attacks against clients.
</P>
<P>
While these types of attack usually rely on understanding the internals of code on the server, developers often make this very easy. An example of this is 
scripts that run arbitrary code sent to them. Such scripts easily allow for 
<A href="http://en.wikipedia.org/wiki/Code_injection">injection</A> attacks, where the attacker simply creates a new page that sends in the code they want executed. 
You might imagine 
that allowing arbitrary code to run was unusual, but, for example, if you send a server SQL queries, and don't check what they are 
doing, you are opening yourself up to a <A href="http://en.wikipedia.org/wiki/SQL_injection">SQL injection attack</A>.
</P>
<P>
Finally, any server script that demands a password to be input opens itself to brute-force password attacks, so should have strong passwords. 
</P>
<HR>
<P> 
Plainly there's a good deal to get your head around, and we'll come back to some resources at the end. In the meantime, a few hints help for beginners:
</P>
<OL>
<LI>Avoid writing scripts that run arbitrary code passed in as input.</LI>  
<LI>Avoid writing scripts that involve the shell to run code.</LI>
<LI>Always check input for characters that might be used in shell scripts or programs and clean them out, for example: ()[]{}|&amp;;`'\"*?~&lt;&gt;>^$\n\r (we'll look at this "sanitization" shortly).</LI>
<LI>Always assign array lengths properly and deal with the issue of input that is too long for your arrays explicitly.</LI>
<LI>If you use third-party libraries or software, keep them up to date.</LI>
<LI>Always use built-in methods for data transfer where they exist, rather than building these yourself.</LI>
</OL>
<P>
A starters guide to attacks against scripts can be found on the <A href="http://www.w3.org/Security/Faq/wwwsf4.html">w3c security site</A> 
(<a href="http://www.w3.org/Security/Faq/wwwsf.html">full FAQ</A> - somewhat dated, but still useful). 
</P>
<P>
Finally, note that while direct attacks against server software are generally rare, they do happen. Classic examples include 
the <A href="http://en.wikipedia.org/wiki/Heartbleed">Heartbleed bug</A> and <A href="http://en.wikipedia.org/wiki/Shellshock_%28software_bug%29">Shellshock</A>, 
both of which exploited deep issues with fundamental elements of 
key software that had gone undetected. Some have argued <A href="http://securityintelligence.com/heartbleed-and-shellshock-the-new-norm-in-vulnerabilities/">that these kinds of exploits will become more important 
as open source software increases</A>, though generally most people subscribe to <A href="http://en.wikipedia.org/wiki/Linus%27s_Law">Linus' Law</A> that bugs are more likely to get spotted with a 
community working on open source code.
</P>
 


<hr class="post_float">[ Next: <a href="dos.html">Attacks against business</a>]<br>
[<a href="../../../web-based-gis/materials.html">Course Index</a>]<br>
<hr class="post_float">
</body></html>